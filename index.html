<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Namaz Vakitleri</title>
</head>
<body>
<h1>Namaz Vakitleri</h1>
<div id="namaz-text">Yükleniyor...</div>

<script>
// Kullanıcının konumu için sabit şehir
const city = "Istanbul";
const country = "Turkey";

// Namaz isimlerini Türkçe eşleştirme
const namazTurkce = {
    Fajr: "Sabah Namazı",
    Dhuhr: "Öğle Namazı",
    Asr: "İkindi Namazı",
    Maghrib: "Akşam Namazı",
    Isha: "Yatsı Namazı"
};

// Şu anki zamana göre kalan süreyi saat+dakika formatında hesapla
function kalanSureSaatDakika(vakit) {
    const now = new Date();
    const [saat, dakika] = vakit.split(":");
    const vakitDate = new Date();
    vakitDate.setHours(parseInt(saat), parseInt(dakika), 0, 0);

    let fark = (vakitDate - now) / 1000; // saniye
    if (fark < 0) fark = 0;

    const saatFark = Math.floor(fark / 3600);
    const dakikaFark = Math.floor((fark % 3600) / 60);

    return { saat: saatFark, dakika: dakikaFark };
}

// API'den namaz vakitlerini çek
fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=13`)
  .then(res => res.json())
  .then(data => {
    const timings = data.data.timings;

    // Beş vakit namaz
    const besVakit = ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"];

    let metin = "";
    besVakit.forEach(vakit => {
        const kalan = kalanSureSaatDakika(timings[vakit]);
        metin += `${namazTurkce[vakit]}: ${kalan.saat} saat ${kalan.dakika} dakika kaldı.<br>`;
    });

    // En yakın vakti bul
    let enYakinVakit = null;
    let enKisaFark = Infinity;
    besVakit.forEach(vakit => {
        const kalan = kalanSureSaatDakika(timings[vakit]);
        const toplamDakika = kalan.saat * 60 + kalan.dakika;
        if (toplamDakika > 0 && toplamDakika < enKisaFark) {
            enKisaFark = toplamDakika;
            enYakinVakit = vakit;
        }
    });

    if (enYakinVakit) {
        metin += `<br>Şu anki vaktin: ${namazTurkce[enYakinVakit]} (yaklaşık ${Math.floor(enKisaFark/60)} saat ${enKisaFark%60} dakika kaldı)<br>`;
    } else {
        metin += `<br>Şu anki vaktin: Tüm namazlar geçti<br>`;
    }

    document.getElementById("namaz-text").innerHTML = metin;
  })
  .catch(err => {
    document.getElementById("namaz-text").innerText = "Namaz vakitleri alınamadı.";
    console.error(err);
  });
</script>
</body>
</html>
