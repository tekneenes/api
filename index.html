<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Namaz Vakitleri</title>
</head>
<body>
<h1>Namaz Vakitleri</h1>
<div id="namaz-text">Yükleniyor...</div>

<script>
// Sabit şehir
const city = "Istanbul";
const country = "Turkey";

// Namaz isimleri Türkçe
const namazTurkce = {
    Fajr: "Sabah vakti",
    Dhuhr: "Öğle vakti",
    Asr: "İkindi vakti",
    Maghrib: "Akşam vakti",
    Isha: "Yatsı vakti"
};

// Şu anki zamana göre kalan süreyi saat+dakika formatında
function kalanSureSaatDakika(vakit) {
    const now = new Date();
    const [saat, dakika] = vakit.split(":");
    const vakitDate = new Date();
    vakitDate.setHours(parseInt(saat), parseInt(dakika), 0, 0);

    let fark = (vakitDate - now) / 1000; // saniye
    if (fark < 0) fark = 0;

    const saatFark = Math.floor(fark / 3600);
    const dakikaFark = Math.floor((fark % 3600) / 60);

    return { saat: saatFark, dakika: dakikaFark, toplamDakika: saatFark*60+dakikaFark };
}

// API'den namaz vakitlerini çek
fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=13`)
  .then(res => res.json())
  .then(data => {
    const timings = data.data.timings;

    const besVakit = ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"];
    let metin = "";

    // Beş vakit için süre
    besVakit.forEach(vakit => {
        const kalan = kalanSureSaatDakika(timings[vakit]);
        metin += `${namazTurkce[vakit]}ne ${kalan.saat} saat ${kalan.dakika} dakika kaldı.\n`;
    });

    // En yakın vakti bul
    let enYakinVakit = null;
    let enKisaFark = Infinity;
    besVakit.forEach(vakit => {
        const kalan = kalanSureSaatDakika(timings[vakit]);
        if (kalan.toplamDakika > 0 && kalan.toplamDakika < enKisaFark) {
            enKisaFark = kalan.toplamDakika;
            enYakinVakit = vakit;
        }
    });

    if (enYakinVakit) {
        const saat = Math.floor(enKisaFark / 60);
        const dakika = enKisaFark % 60;
        metin += `\nŞu anki vakit ${namazTurkce[enYakinVakit]} çıkmasına yaklaşık ${saat} saat ${dakika} dakika var.`;
    } else {
        metin += `\nŞu anki vakit: Tüm namazlar geçti.`;
    }

    document.getElementById("namaz-text").innerText = metin;
  })
  .catch(err => {
    document.getElementById("namaz-text").innerText = "Namaz vakitleri alınamadı.";
    console.error(err);
  });
</script>
</body>
</html>
